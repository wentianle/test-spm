define("#ucloud/1.0.0/ucloud",["es5-safe","json","#jquery/1.8.2/jquery","#underscore/1.4.2/underscore","#backbone/0.9.2/backbone","$","base64","console/umodel/1.0.0/umodel","plugins","util","sidebar","menus","uhost_list","udisk_list","udb_list","backup_list","param_list","snapshot_list","uimage_list","ufirewall_list","probe_list","monitor_group","palarm_list","ucdn_list","ucdn_bandwidth","ucdn_flow","ucdn_log","ucdn_loganalysis","domain","popup","record","domain.setting","domain.statistics","dns_login","rule_list","action_list","cache"],function(e,t,n){function H(e,t){var n=0,r=0;return n=Math.floor(e/8),r=e%8,t[n]?1<<7-r&t[n]:!1}e("es5-safe"),e("json");var r=e("#jquery/1.8.2/jquery"),i=e("#underscore/1.4.2/underscore"),s=e("#backbone/0.9.2/backbone"),o=e("base64"),u=e("console/umodel/1.0.0/umodel");e("plugins")(r);var a=e("util"),f=e("sidebar"),l=e("menus"),c=e("uhost_list"),h=e("udisk_list"),p=e("udb_list"),d=e("backup_list"),v=e("param_list"),m=e("snapshot_list"),g=e("uimage_list"),y=e("ufirewall_list"),b=e("probe_list"),w=e("monitor_group"),E=e("palarm_list"),S=e("ucdn_list"),x=e("ucdn_bandwidth"),T=e("ucdn_flow"),N=e("ucdn_log"),C=e("ucdn_loganalysis"),k=e("domain"),L=e("popup"),A=e("record"),O=e("domain.setting"),M=e("domain.statistics"),_=e("dns_login"),D=e("rule_list"),P=e("action_list");window.Events=i.extend({},s.Events),window.Cache=e("cache");var B=s.Router.extend({initialize:function(){var e=i.map(o.decode(UCLOUD.user.bitmaps).split(""),function(e){return e.charCodeAt(0)}),t=i.filter(l.menus,function(t,n){if(UCLOUD.user&&H(t.permission,e))return{label:t.label,link:t.link,key:t.key}});this.GlobalMenus=new f.Views.GlobalMenus({menus:t}),this.GlobalMenus.render(),this.GlobalMenus.router=this,a.initGlobalLayout(),window.Events.bind("navigate",this.navigate,this)},routes:{"":"uhost","uhost/:action":"uhost","udisk/:action":"udisk","udb/:action":"udb","ucdn/:action":"ucdn","udns/:action":"udns","udns/record/:domain":"record"},ucloud:function(){this.navigate("uhost/uhost",!0)},uhost:function(e){window.Events.off(),e||(e="uhost");var t=r("#inner-main").html(""),n=r("#inner-north").html("");a.initInnerLayout();var i=r("#west-center > .ui-layout-content").html("");this.Sidebar=new f.Views.Sidebar({menus:l.menus.uhost.items,product:l.menus.uhost.key}),this.Sidebar.router=this,i.append(this.Sidebar.render().el),this.Sidebar.current(e),this.GlobalMenus.current(l.menus.uhost.key);switch(e){case"uhost":a.closeDesc(),a.openActions(),this.collection=new u.Collections.Uhost,this.ActionView=new c.Views.UhostActions({collection:this.collection}),this.ActionView.router=this,n.append(this.ActionView.render().el),this.ListView=new c.Views.UhostList({collection:this.collection}),t.append(this.ListView.render().el);break;case"uimage":a.closeDesc(),a.openActions(),this.collection=new u.Collections.Image,this.ActionView=new g.Views.UimageActions({collection:this.collection}),n.append(this.ActionView.render().el),this.ListView=new g.Views.UimageList({collection:this.collection}),t.append(this.ListView.render().el);break;case"ufirewall":a.closeDesc(),a.openActions(),this.collection=new u.Collections.Ufirewall,this.ActionView=new y.Views.UfirewallActions({collection:this.collection}),n.append(this.ActionView.render().el),this.ListView=new y.Views.UfirewallList({collection:this.collection}),t.append(this.ListView.render().el);break;case"probe":a.closeDesc(),a.openActions(),this.collection=new u.Collections.Probe,this.ActionView=new b.Views.ProbeActions({collection:this.collection}),n.append(this.ActionView.render().el),this.ListView=new b.Views.ProbeList({collection:this.collection}),t.append(this.ListView.render().el);break;case"umonitor":a.closeDesc(),a.openActions(),a.closeActions(),this.collection=new u.Collections.Probe,this.indicators=new u.Collections.Indicator,this.currentData=new u.Collections.MonitorCurrentData,this.ActionView=new w.Views.MonitorActions({indicators:this.indicators,collection:this.currentData}),t.append(this.ActionView.render().el),this.MonitorDataList=new w.Views.MonitorDataList({indicators:this.indicators,currentData:this.currentData}),t.append(this.MonitorDataList.render().el);break;case"palarm":a.closeDesc(),a.openActions(),this.collection=new u.Collections.Palarm,this.ActionView=new E.Views.PalarmActions({collection:this.collection}),n.append(this.ActionView.render().el),this.ListView=new E.Views.PalarmList({collection:this.collection}),t.append(this.ListView.render().el);break;case"rule":a.closeDesc(),a.closeActions(),this.rule_collection=new u.Collections.SchedulerRule,this.RuleActionView=new D.Views.RuleActions({collection:this.rule_collection}),t.append(this.RuleActionView.render().el),this.RuleListView=new D.Views.RuleList({collection:this.rule_collection}),t.append(this.RuleListView.render().el),this.scheduler_action_collection=new u.Collections.SchedulerAction,this.SchedulerActionView=new P.Views.SchedulerActionActions({collection:this.scheduler_action_collection}),t.append(this.SchedulerActionView.render().el),this.SchedulerActionListView=new P.Views.SchedulerActionList({collection:this.scheduler_action_collection}),t.append(this.SchedulerActionListView.render().el)}},udisk:function(e){window.Events.off(),e||(e="udisk");var t=r("#inner-main").html(""),n=r("#inner-north").html("");a.initInnerLayout();var i=r("#west-center > .ui-layout-content").html("");this.Sidebar=new f.Views.Sidebar({menus:l.menus.udisk.items,product:l.menus.udisk.key}),this.Sidebar.router=this,i.append(this.Sidebar.render().el),this.GlobalMenus.current(l.menus.udisk.key),this.Sidebar.current(e),a.closeDesc(),a.openActions();switch(e){case"udisk":this.collection=new u.Collections.Udisk,this.ActionView=new h.Views.UdiskActions({collection:this.collection}),this.ActionView.router=this,n.append(this.ActionView.render().el),this.ListView=new h.Views.UdiskList({collection:this.collection}),this.ListView.router=this,t.append(this.ListView.render().el);break;case"snapshot":this.collection=new u.Collections.Snapshot,this.ActionView=new m.Views.SnapshotActions({collection:this.collection}),this.ActionView.router=this,n.append(this.ActionView.render().el),this.ListView=new m.Views.SnapshotList({collection:this.collection}),this.ListView.router=this,t.append(this.ListView.render().el)}},udb:function(e){window.Events.off(),e||(e="instance");var t=r("#inner-main").html(""),n=r("#inner-north").html("");a.initInnerLayout();var i=r("#west-center > .ui-layout-content").html("");this.Sidebar=new f.Views.Sidebar({menus:l.menus.udb.items,product:l.menus.udb.key}),this.Sidebar.router=this,i.append(this.Sidebar.render().el),this.GlobalMenus.current(l.menus.udb.key),this.Sidebar.current(e),a.closeDesc(),a.openActions();switch(e){case"instance":this.collection=new u.Collections.Udb,this.ActionView=new p.Views.UdbActions({collection:this.collection}),this.ActionView.router=this,n.append(this.ActionView.render().el),this.ListView=new p.Views.UdbList({collection:this.collection}),this.ListView.router=this,t.append(this.ListView.render().el);break;case"backup":this.collection=new u.Collections.Backup,this.ActionView=new d.Views.BackupActions({collection:this.collection}),this.ActionView.router=this,n.append(this.ActionView.render().el),this.ListView=new d.Views.BackupList({collection:this.collection}),this.ListView.router=this,t.append(this.ListView.render().el);break;case"param":this.collection=new u.Collections.Param,this.ActionView=new v.Views.ParamActions({collection:this.collection}),this.ActionView.router=this,n.append(this.ActionView.render().el),this.ListView=new v.Views.ParamList({collection:this.collection}),this.ListView.router=this,t.append(this.ListView.render().el)}},ucdn:function(e){window.Events.off(),e||(e="ucdn");var t=r("#inner-main").html(""),n=r("#inner-north").html("");a.initInnerLayout();var i=r("#west-center > .ui-layout-content").html("");this.Sidebar=new f.Views.Sidebar({menus:l.menus.ucdn.items,product:l.menus.ucdn.key}),this.Sidebar.router=this,i.append(this.Sidebar.render().el),this.GlobalMenus.current(l.menus.ucdn.key),this.Sidebar.current(e),a.closeDesc(),a.openActions();switch(e){case"ucdn":this.collection=new u.Collections.Ucdn,this.ActionView=new S.Views.UcdnActions({collection:this.collection}),this.ActionView.router=this,n.append(this.ActionView.render().el),this.ListView=new S.Views.UcdnList({collection:this.collection}),this.ListView.router=this,t.append(this.ListView.render().el);break;case"bandwidth":a.closeActions(),this.collection=new u.Collections.Ucdn,this.ActionView=new x.Views.BandWandwidthActions({collection:this.collection,parent:t}),this.ActionView.render();break;case"flow":a.closeActions(),this.collection=new u.Collections.Ucdn,this.ActionView=new T.Views.UcdnFlowActions({collection:this.collection,parent:t}),this.ActionView.render();break;case"logfile":this.cdn_domain=new u.Collections.Ucdn,this.collection=new u.Collections.UcdnLog,this.ActionView=new N.Views.UcdnLogActions({cdn_domain:this.cdn_domain,collection:this.collection}),n.append(this.ActionView.render().el),this.ListView=new N.Views.UcdnLogList({collection:this.collection}),t.append(this.ListView.render().el);break;case"loganalysis":this.cdn_domain=new u.Collections.UcdnLogAnalysisDomain,this.collection=new u.Collections.UcdnLogAnalysis,this.ActionView=new C.Views.UcdnLogAnalysisActions({cdn_domain:this.cdn_domain,collection:this.collection}),n.append(this.ActionView.render().el),this.ListView=new C.Views.UcdnLogAnalysisList({collection:this.collection}),t.append(this.ListView.render().el)}},udns:function(e,t){var n=r("#west-center > .ui-layout-content").html("");this.Sidebar=new f.Views.Sidebar({menus:l.menus.udns.items,product:l.menus.udns.key}),this.Sidebar.router=this,n.append(this.Sidebar.render().el),this.GlobalMenus.current(l.menus.udns.key),this.Sidebar.current(e);var i=r("#inner-main").html("");a.initInnerLayout(),a.closeDesc(),a.closeActions();switch(e){case"login":if(window.UCLOUD.user.dnspod_email&&window.UCLOUD.user.dnspod_passwd){this.navigate("/udns/domain",!0);return}r.ajax({url:"/udns/domain/getBindInfo",type:"GET",cache:!1,async:!1,dataType:"json",success:function(e){if(e.ret_code==0)if(e.data.dnspod_email&&e.data.dnspod_passwd)window.UCLOUD.user=e.data,window.router.navigate("/udns/domain",!0);else{var t=new _.Views.DnsLogin;i.append(t.render().el)}}});break;case"domain":if(!window.UCLOUD.user.dnspod_email||!window.UCLOUD.user.dnspod_passwd){this.navigate("/udns/login",!0);return}i.append(r("<div class='dns'></div>")),this.collection=new k.Collections.DomainList;var s={collection:this.collection};this.actionsView=this.actionsViewOption||new k.Views.DomainActions(s),this.actionsView.router=this,i.find(".dns").append(this.actionsView.render().el),this.listView=new k.Views.DomainList({collection:this.collection}),this.listView.router=this,i.find(".dns").append(this.listView.render().el)}},record:function(e,t){var n=r("#west-center > .ui-layout-content").html("");this.Sidebar=new f.Views.Sidebar({menus:l.menus.udns.items,product:l.menus.udns.key}),this.Sidebar.router=this,n.append(this.Sidebar.render().el),this.GlobalMenus.current(l.menus.udns.key),this.Sidebar.current("domain");var i=r("#inner-main").html("");a.initInnerLayout(),a.closeDesc(),a.closeActions();if(!window.UCLOUD.user.dnspod_email||!window.UCLOUD.user.dnspod_passwd){this.navigate("/udns/login",!0);return}i.append(r("<div id='main' class='dns'></div>"));var s=r("#main").html(""),o=this;if(/。/.test(e))return this.navigate("/udns/record/"+e.replace("。","."),!0),!1;var u;if(!this.current_domain||!this.current_domain.get("id")||e!=this.current_domain.get("name")){var c=null;r.ajax({url:"/udns/api_proxy/post",data:{api_name:"/Api/Domain.Info",domain:e},type:"POST",async:!1,dataType:"json",success:function(e){e.status.code==1?o.current_domain=new k.Models.Domain(e.domain):e.alias?c=e.alias.name:c="/"}})}if(c)return o.navigate(c,!0),!1;if(!o.current_domain)return o.navigate("/",!0),!1;u=o.current_domain.get("id");var s=r("#main").html("");this.record_collection=new A.Collections.RecordList([],{domain:u,domain_model:this.current_domain}),s.append(r("<div class='RecordHeader'></div>"));var h=new A.Views.DomainHeader({tab:"records",domain_title:e,current_domain:this.current_domain,collection:this.record_collection});s.find(".RecordHeader").append(r(h.render().el));var p=new A.Views.RecordActions({domain:u,domain_title:e,current_domain:this.current_domain,collection:this.record_collection});s.find(".RecordHeader").append(r(p.render().el));var d=new A.Views.RecordList({domain:u,collection:this.record_collection});s.append("<div id='main-content'></div>"),s.find("#main-content").append(r(d.render().el)),this.record_collection.getRecordList(t||0)}});window.router=new B,s.history.start(),r(".dropdown-toggle").dropdown(),r("[rel=popover]").popover(),r("[rel=twipsy]").tooltip({placement:"top"}),r("body").delegate("[rel=twipsy]","mouseenter",function(){r("[rel=twipsy]").tooltip()}),r("[rel=popover]").popover({offset:10,html:!0,live:!0}),r("body").delegate("#help_btn","click",function(){var e=r(this);r("div.help_"+e.attr("site")).toggle("slow")})});